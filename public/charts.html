<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>SafeLink - Charts</title>

  <!-- Custom fonts for this template-->
  <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">

  <!-- Custom styles for this template-->
  <link href="css/sb-admin-2.min.css" rel="stylesheet">
</head>

<body id="page-top">
  <!-- me begin -->
  <script>
  function doFunction(){
    $('.loader-container').addClass('loader');
    document.getElementById('safetyRating').innerHTML = '';
    var area = document.getElementById("zipcode").value;

    var chicago_zips = ["60637", "60654", "60131", "60645", "60644", "60018", "60176", "60661", "60660", "60655",
    "60639", "60706", "60605", "60604", "60607", "60606", "60601", "60626", "60603", "60602", "60641", "60640",
    "60629", "60628", "60609", "60608", "60647", "60646", "60714", "60659", "60707", "60651", "60623", "60622",
    "60656", "60621", "60649", "60068", "60620", "60007", "60638", "60106", "60625", "60616", "60617", "60614",
    "60615", "60612", "60613", "60610", "60611", "60634", "60653", "60636", "60624", "60630", "60631", "60618",
    "60619", "60652", "60657", "60827", "60632", "60643", "60804","60642", "60633"]
    var n = chicago_zips.includes(area.toString());

    if(n == false)
    {
      alert("Please enter a valid Chicago Zip Code. For example: '60007'");
      $('.loader-container').removeClass('loader');
    }
    else{
      $.ajax({
        "method": "GET",
        "url": "/community",
        "data": {area: area}
      }).then(function(response){
        var data, mapping = (response['obj'], response['areas']);
        // console.log(data)
        data = response['obj']

        // console.log(data)
        var violent_crimes = ["SEX OFFENSE", "CRIM SEXUAL ASSAULT", "BATTERY", "ASSAULT", "KIDNAPPING", "HOMICIDE", "HUMAN TRAFFICKING"];
        var secondary_crimes = ["ROBBERY", "CRIMINAL DAMAGE", "THEFT", "ARSON", "BURGLARY", "MOTOR VEHICLE THEFT", "STALKING", "INTIMIDATION"];
        var crime_index = {};
        var rating = 0 ;
        var rating_string = '';
        var total_pop = 2716000;
        var pop_to_comm = total_pop/77;
        for(var k in data) crime_index[k]=data[k];
        Object.keys(crime_index).forEach(function (item) {
          crime_index[item] = ((crime_index[item] / total_pop) * 100000);
        });

        Object.keys(crime_index).forEach(function (item) {
          if(violent_crimes.includes(item))
          {

            rating = (crime_index[item] * 1.50) + rating; // if violent the rate in which to multiple is 1.25
          }
          else if (secondary_crimes.includes(item)){

            rating = (crime_index[item] * 1.25) + rating; //take off a factor
          }
          else{
            rating = (crime_index[item] * 1) + rating;
          }
        });

        if(rating < 2500){
          console.log("Safe neighbor hood: about 85% safe");
          rating_string = "Safe neighbor hood: about 85% safe";
        }
        else if(rating > 2500 && rating < 5000)
        {
          console.log("Moderate neighborhood: is about 70% safe");
          rating_string = "Moderate neighborhood: is about 70% safe";
        }
        else if(rating > 5000 && rating < 7500)
        {
          console.log("This neighborhood is neither safe nor unsafe");
          rating_string = "This neighborhood is neither safe nor unsafe";
        }
        else{
          console.log("This neighborhood is not safe");
          rating_string = "This neighborhood is not safe";
        }

        var round = Math.round(rating);


        document.getElementById('safetyRating').innerHTML = "<h6> For the community areas for the zip code: " + area + " the crime rate per 100,000 citizens is: " + round + ". Safety Score: " + rating_string +"</h6>" ;
        $('.loader-container').removeClass('loader');

      });
    }
  }
  </script>
  <!-- me end -->
  <!-- Page Wrapper -->
  <div id="wrapper">

    <!-- Sidebar -->
    <ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="accordionSidebar">

      <!-- Sidebar - Brand -->
      <a class="sidebar-brand d-flex align-items-center justify-content-center" href="index.html">
        <div class="sidebar-brand-icon rotate-n-15">
          <!-- <i class="fas fa-laugh-wink"></i> -->
        </div>
        <div class="sidebar-brand-text mx-3">SafeLink</div>
      </a>

      <!-- Divider -->
      <hr class="sidebar-divider my-0">

      <!-- Nav Item - Dashboard -->
      <li class="nav-item">
        <a class="nav-link" href="index.html">
          <i class="fas fa-fw fa-tachometer-alt"></i>
          <span>Dashboard</span></a>
        </li>

        <!-- Divider -->
        <hr class="sidebar-divider">

        <!-- Heading -->
        <!-- <div class="sidebar-heading">
        Interface
      </div> -->

      <!-- Nav Item - Pages Collapse Menu -->
      <!-- <li class="nav-item">
      <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
      <i class="fas fa-fw fa-cog"></i>
      <span>Components</span>
    </a>
    <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar">
    <div class="bg-white py-2 collapse-inner rounded">
    <h6 class="collapse-header">Custom Components:</h6>
    <a class="collapse-item" href="buttons.html">Buttons</a>
    <a class="collapse-item" href="cards.html">Cards</a>
  </div>
</div>
</li> -->

<!-- Nav Item - Utilities Collapse Menu -->
<!-- <li class="nav-item">
<a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseUtilities" aria-expanded="true" aria-controls="collapseUtilities">
<i class="fas fa-fw fa-wrench"></i>
<span>Utilities</span>
</a>
<div id="collapseUtilities" class="collapse" aria-labelledby="headingUtilities" data-parent="#accordionSidebar">
<div class="bg-white py-2 collapse-inner rounded">
<h6 class="collapse-header">Custom Utilities:</h6>
<a class="collapse-item" href="utilities-color.html">Colors</a>
<a class="collapse-item" href="utilities-border.html">Borders</a>
<a class="collapse-item" href="utilities-animation.html">Animations</a>
<a class="collapse-item" href="utilities-other.html">Other</a>
</div>
</div>
</li> -->

<!-- Divider -->
<hr class="sidebar-divider">

<!-- Heading -->
<!-- <div class="sidebar-heading">
Addons
</div>

<!-- Nav Item - Pages Collapse Menu -->
<!-- <li class="nav-item">
<a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapsePages" aria-expanded="true" aria-controls="collapsePages">
<i class="fas fa-fw fa-folder"></i>
<span>Pages</span>
</a>
<div id="collapsePages" class="collapse" aria-labelledby="headingPages" data-parent="#accordionSidebar">
<div class="bg-white py-2 collapse-inner rounded">
<h6 class="collapse-header">Login Screens:</h6>
<a class="collapse-item" href="login.html">Login</a>
<a class="collapse-item" href="register.html">Register</a>
<a class="collapse-item" href="forgot-password.html">Forgot Password</a>
<div class="collapse-divider"></div>
<h6 class="collapse-header">Other Pages:</h6>
<a class="collapse-item" href="404.html">404 Page</a>
<a class="collapse-item" href="blank.html">Blank Page</a>
</div>
</div>
</li> -->

<!-- Nav Item - Charts -->
<li class="nav-item active">
    <a class="nav-link" href="charts.html">
      <i class="fas fa-fw fa-chart-area"></i>
      <span>Community Area - Zip</span></a>
  </li>
  <li class="nav-item">
      <a class="nav-link" href="safeareas.html">
        <i class="fas fa-fw fa-chart-area"></i>
        <span>Community Area - Area</span></a>
    </li>

  <!-- Nav Item - SSL Dashboard -->
  <li class="nav-item">
    <a class="nav-link" href="ssl.html">
      <i class="fas fa-fw fa-chart-area"></i>
      <span>SSL</span></a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="domestic.html">
      <i class="fas fa-fw fa-chart-area"></i>
      <span>Domestic</span></a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="2019.html">
      <i class="fas fa-fw fa-chart-area"></i>
      <span>2019</span></a>
  </li>

  <!-- Nav Item - Tables -->
  <li class="nav-item">
    <a class="nav-link" href="/tables">
      <i class="fas fa-fw fa-table"></i>
      <span>Crime Incident Report</span></a>
    </li>

    <!-- Divider -->
    <hr class="sidebar-divider d-none d-md-block">

    <!-- Sidebar Toggler (Sidebar) -->
    <div class="text-center d-none d-md-inline">
      <button class="rounded-circle border-0" id="sidebarToggle"></button>
    </div>

  </ul>
  <!-- End of Sidebar -->

  <!-- Content Wrapper -->
  <div id="content-wrapper" class="d-flex flex-column">

    <!-- Main Content -->
    <div id="content">



<!-- Begin Page Content -->
<div class="container-fluid">

  <!-- Page Heading -->
  <h1 class="h3 mb-2 text-gray-800">SafeLink Community Area Charts</h1>
  <!-- my code begin -->
  <!-- <form class="form-wrapper" method="get" action="/community" >
  <input type="text" id="zipcode" name="zipcode" pattern="\d{5}" maxlength="5" placeholder="Enter Zip Code" required>
  <input type="submit" value="go" id="submit">
</form> -->
<form class="d-none d-sm-inline-block form-inline mr-auto ml-md-3 my-2 my-md-0 mw-100 navbar-search">
  <div class="input-group">
    <input type="text" class="form-control bg-light border-0 small" id="zipcode" name="zipcode" pattern="\d{5}" maxlength="5" placeholder="Enter Zip Code" aria-label="Search" aria-describedby="basic-addon2">
    <div class="input-group-append">
      <button class="btn btn-primary" type="button" onclick="doFunction()" id="zipcode">
        <i class="fas fa-search fa-sm"></i>
      </button>
    </div>
  </div>
</form>
<!-- my code end -->
<div class="loader-container">
  <p>Loading</p>
</div>
<div  id="safetyRating">

<!-- class="col-xl-4 col-lg-5" -->
 <!-- <img src="img/spinner.gif" alt=""> -->
  <!-- <p>Loading</p> -->
</div>
<!-- </div> -->



<!-- Content Row -->
<div class="row">

  <div class="col-lg-12">
<div class="dashboard">
    <div class='tableauPlaceholder' id='viz1556412022387' style='position: relative'>
      <noscript>
        <a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;3C&#47;3CWNRNJYT&#47;1_rss.png' style='border: none' /></a>
      </noscript>
      <object class='tableauViz'  style='display:none;'>
        <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' />
        <param name='embed_code_version' value='3' />
        <param name='path' value='shared&#47;3CWNRNJYT' />
        <param name='toolbar' value='no' />
        <param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;3C&#47;3CWNRNJYT&#47;1.png' />
        <param name='animate_transition' value='yes' />
        <param name='display_static_image' value='yes' />
        <param name='display_spinner' value='yes' />
        <param name='display_overlay' value='yes' />
        <param name='display_count' value='yes' />
        <param name='filter' value='publish=yes' />
      </object>
    </div>
    <script type='text/javascript'>
    var divElement = document.getElementById('viz1556412022387');
    var vizElement = divElement.getElementsByTagName('object')[0];
    if ( divElement.offsetWidth > 800 )
    {
      vizElement.style.width='100%';
      vizElement.style.height=(divElement.offsetWidth*0.75)+'px';
    }
    else if( divElement.offsetWidth > 500 )
    {
      vizElement.style.width='100%';
      vizElement.style.height=(divElement.offsetWidth*0.75)+'px';
    }
    else { vizElement.style.width='100%';vizElement.style.height='1500px';}
    var scriptElement = document.createElement('script');
    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';
    vizElement.parentNode.insertBefore(scriptElement, vizElement);
    </script>

</div>
</div>
</div>

</div>
    <!-- Area Chart -->
    <!-- <div class="card shadow mb-4">
      <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-primary">Area Chart</h6>
      </div>
      <div class="card-body">
        <div class="chart-area">
          <canvas id="myAreaChart"></canvas>
        </div>
        <hr>
        Styling for the area chart can be found in the <code>/js/demo/chart-area-demo.js</code> file.
      </div>
    </div>

    <!-- Bar Chart -->
    <!-- <div class="card shadow mb-4">
      <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-primary">Bar Chart</h6>
      </div>
      <div class="card-body">
        <div class="chart-bar">
          <canvas id="myBarChart"></canvas>
        </div>
        <hr>
        Styling for the bar chart can be found in the <code>/js/demo/chart-bar-demo.js</code> file.
      </div>
    </div> -->

  <!-- </div> -->

  <!-- Donut Chart -->
  <!-- <div id="safetyRating"> -->
  <!-- <div class="col-xl-4 col-lg-5" id="safetyRating">

    <div class="loader-container"> -->
   <!-- <img src="img/spinner.gif" alt=""> -->
    <!-- <p>Loading</p> -->

    <!-- //</div> -->
    <!-- <div class="card shadow mb-4"> -->
      <!-- Card Header - Dropdown -->
      <!-- <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-primary">Donut Chart</h6>
      </div> -->
      <!-- Card Body -->
      <!-- <div class="card-body">
        <!-- <div class="chart-pie pt-4">
          <!-- <canvas id="myPieChart"></canvas> -->
        <!-- </div> -->
        <!-- <hr>
        Styling for the donut chart can be found in the <code>/js/demo/chart-pie-demo.js</code> file.
      </div> -->
    <!-- </div> -->
  <!-- </div>
  </div> -->
  <!-- </div> -->

</div>

</div>
<!-- /.container-fluid -->

</div>
<!-- End of Main Content -->

<!-- Footer -->
<!-- <footer class="sticky-footer bg-white">
  <div class="container my-auto">
    <div class="copyright text-center my-auto">
      <span>Copyright &copy; Your Website 2019</span>
    </div>
  </div>
</footer> -->
<!-- End of Footer -->

</div>
<!-- End of Content Wrapper -->

</div>
<!-- End of Page Wrapper -->

<!-- Scroll to Top Button-->
<a class="scroll-to-top rounded" href="#page-top">
  <i class="fas fa-angle-up"></i>
</a>

<!-- Logout Modal-->
<!-- <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
<button class="close" type="button" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">Ã—</span>
</button>
</div>
<div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
<div class="modal-footer">
<button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
<a class="btn btn-primary" href="login.html">Logout</a>
</div>
</div>
</div>
</div> -->

<!-- Bootstrap core JavaScript-->
<script src="vendor/jquery/jquery.min.js"></script>
<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

<!-- Core plugin JavaScript-->
<script src="vendor/jquery-easing/jquery.easing.min.js"></script>

<!-- Custom scripts for all pages-->
<script src="js/sb-admin-2.min.js"></script>

<!-- Page level plugins -->
<script src="vendor/chart.js/Chart.min.js"></script>

<!-- Page level custom scripts -->
<script src="js/demo/chart-area-demo.js"></script>
<script src="js/demo/chart-pie-demo.js"></script>
<script src="js/demo/chart-bar-demo.js"></script>
<!-- my code begin -->
<!-- <script src="js/community.js"></script> -->
<!-- my code end  -->
</body>

</html>
